Tmux – терминальный мультиплексор
=================================

.. default-role:: code
.. contents:: Содержание

Tmux — это консольная утилита, предоставляющая пользователю доступ к
нескольким терминалам в рамках одного экрана. Простыми словами,
используя эту утилиту можно в одном окне открыть несколько терминальных
окон. Также возможно подключение к существующей сессии из другого
рабочего места не прерывая выполнение определенных задач.

.. image:: {static}./images/tmux/01.png
    :alt: 01

Как видно из скриншота, у нас несколько консольных панелей в одном окне.
Очень удобно работать. Приступим к более подробному рассмотрению. Для
установки tmux утилиты в Linux достаточно
выполнить команду:

.. code:: bash

    sudo apt-install tmux

После установки программы можно приступать к использованию

Вводим команду:

.. code:: bash

    tmux

Происходит запуск утилиты. Понять, что мы находимся в tmux можно по наличию зеленой строки внизу консоли, на которой размещены дата и время.

.. image:: {static}/images/tmux/02.png
    :alt: 02


По умолчанию создается одна панель на весь экран. Для того, чтобы
добавить вертикальную панель необходимо воспользоваться сервисными
клавишами «Ctrl+B»(система понимает, что вы вводите не консольную
команду, а пользуетесь функцией терминального мультиплексера), далее
нажимаете «Shift+%». Справа создается еще одна панель.

.. image:: {static}/images/tmux/03.png
    :alt: 03

Теперь в рамках одного окна у вас есть две рабочие зоны.

Для переключения между панелями воспользуйтесь клавишами «Ctrl+B» далее стрелочками вправо или влево.

Для создания горизонтальной панели нажмите «Crtl+B» далее «Shift+”»
(кавычка находится на русской букве «Э»)

.. image:: {static}/images/tmux/4.png
    :alt: 04

Для изменения размера определенной панели есть следующая комбинация
клавиш:

«Ctrl+B» затем зажимаем Alt и стрелочками изменяем размер.

.. image:: {static}/images/tmux/5.png
    :alt: 05

Для изменения местоположения панели воспользуется комбинацией клавиш
«Ctrl+B» затем «}».

.. image:: {static}/images/tmux/04.png
    :alt: 06



Также есть возможность создать еще одно окно. Для этого предусмотрена
команда «Ctrl+B» «c»

Для просмотра списка окон можно воспользоваться командой «Ctrl+B» «w»

.. image:: {static}/images/tmux/05.png
    :alt: 07


Как видно из скриншота, у нас создалось второе окно. Для удобного
распознавания нужного окна можно присвоить им имена:

.. code:: bash

    tmux rename-window window_name

Также можно воспользоваться командной строкой терминала выполнив команду
«Ctrl+B» «:»

И в командной строке набрать команду «remane-window masinc» (где
«window_name» это новое имя)

Для переименования сессии применяется следующая команда: «tmux
rename-session –t 0 session_name»

-t указывает на номер сессии, если этот параметр опустить будет
переименована существующая сессия.

Для просмотра количества существующих сессий воспользуемся командой

.. code:: bash

    tmux ls

Создадим еще одну сессию tmux, для этого выйдем из существующей сессии:

.. code:: bash

    tmux detach (или Ctrl+B d)

.. code:: bash

    tmux

Посмотрим список созданных сессий:

.. code:: bash

    tmux ls

.. image:: {static}/images/tmux/06.png
    :alt: 06



Для подключения к определенной сессиb воспользуемся командой:

.. code:: bash

    tmux a –t session_name

Мы подключились к сесси «session_name».

Для закрытия сессии необходимо закрыть все панели командой «Ctrl+B» «x».
Затем «у» для подтверждения.

Также для завершения сессии можно воспользоваться командой:

.. code:: bash

    tmux kill-session

Для отключения от сессии с сохранением ее работоспособности есть
несколько вариантов:

.. code:: bash

    tmux detach
.. code:: bash

     tmux d

.. code:: bash

    «Ctrl+B» «d»

Также есть возможность управлять размером окон с помощью мышки. Для
этого в конфигурационный файл /etc/tmux.conf следует добавить следующие
строки:

.. code:: bash

    set -g mouse-resize-pane on

Для применения настроек необходимо перечитать конфигурационный файл

.. code:: bash

    tmux source-file /etc/tmux.conf

Если вы хотите переподключиться к другой сессии выполните команду:

.. code:: bash

    tmux switch –t name

Или же можно воспользоватсья клавишами "Ctrl + B" "s 


Для прокрутки страницы вверх используйте комбинацию клавиш «Ctrl+B»
    «PgUp/PgDwn»

Также очень много удобных дополнительных функций можно добавить внеся
необходимые изменения в конфигурационный файл. Воспользовавшись мануалом
«man tmux» можно получить дополнительную информацию.

1. “Убить” сессию можно следующей командой:

.. code:: bash

    ctrl + b + d

2. Создает новую вкладку:

.. code:: bash

    ctrl + b + b

.. code:: bash

    c

3. Переименовать файл можно:

.. code:: bash

    ctrl + b + ,

4. Выход из тмукса:

.. code:: bash

    ctrl + b + d

5. Разделить окно по вертикали:

.. code:: bash

    ctrl + b + %

6. Разделить окно по горизонтали:

.. code:: bash

    ctrl + b + "

7. Переход между окнами: (к правому окну)

.. code:: bash

    ctrl + b + ->

8. Открыть диспетчер задач:

.. code:: bash

    htop

**Задание**

Выполните следующие действия: 

1. Откройте tmux

.. image:: {static}/images/tmux/t1.jpg
    :alt: t1

2. Создайте четыре окна и измените их размер, как показано на фотографии

.. image:: {static}/images/tmux/t2.jpg
    :alt: t2

3. Откройте в левом верхнем окне диспетчер задач, а в правом верхнем - время (в соответствии с фотографией)

.. image:: {static}/images/tmux/t3.jpg
    :alt: t3

4. Создайте скрипт (или воспользуйтесь скриптом из прошлой лабы), который по выбору пользователя с интервалом печатает цифры. Запустите скрипт в левом нижнем окне.

.. image:: {static}/images/tmux/t4.jpg
    :alt: t4

5. Используя знания о работе с процессами, запустите данный скрипт три раза в левом нижнем окне (при этом цифры, выводящиеся на экран, должны быть различными)

.. image:: {static}/images/tmux/t5.jpg
    :alt: t5

6. В правом нижнем окне отройте используемый скрипт в редакторе vim (на фотографии, конечно, не он)

.. image:: {static}/images/tmux/t6.jpg
    :alt: t6
